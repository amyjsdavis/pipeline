---
title: "Test UTF-8"
author: "Peter Desmet"
date: "r Sys.Date()`"
output: md_document
---

A test document to figure out how to consistently read (and write) data as UTF-8. Use the "Knit" button to run.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Load libraries:

```{r}
library(rgbif)
library(jsonlite)
```

Set taxonKey:

```{r}
taxon_key <- "134087647"
```

Get locale:

```{r}
Sys.getenv("LC_CTYPE")
```

# Default

Get taxon with rgbif:

```{r}
rgbif_taxon <- rgbif::name_usage(key = taxon_key)
rgbif_taxon$data$scientificName
```

Get taxon with jsonlite:

```{r}
jsonlite_taxon <- jsonlite::read_json(paste0("http://api.gbif.org/v1/species/", taxon_key))
jsonlite_taxon$scientificName
```

# Locale `en_US.UTF-8`

```{r}
Sys.setlocale("LC_CTYPE", "en_US.UTF-8")
```

Get taxon:

```{r}
rgbif_taxon <- rgbif::name_usage(key = taxon_key)
rgbif_taxon$data$scientificName
```
